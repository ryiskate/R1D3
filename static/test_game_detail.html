<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Detail Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Include the CSS directly for testing */
        /* Progress Bar Styles */
        .progress {
            height: 25px;
            margin-bottom: 1rem;
        }

        .progress-bar {
            color: white;
            text-align: center;
            line-height: 25px;
            font-weight: 500;
        }

        /* Specific progress bar colors */
        .progress-done {
            background-color: #28a745;
        }

        .progress-review {
            background-color: #17a2b8;
        }

        .progress-in-progress {
            background-color: #007bff;
        }

        .progress-todo {
            background-color: #6c757d;
        }

        .progress-blocked {
            background-color: #dc3545;
        }

        /* Asset Statistics */
        .asset-stats .card-body {
            padding: 1.25rem;
        }

        /* Chart container */
        .chart-container {
            position: relative;
            height: 200px;
            width: 100%;
        }

        /* Asset list styling */
        .asset-list-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }

        .asset-list-item:last-child {
            border-bottom: none;
        }

        /* Test styles to demonstrate infinite scrollbar fix */
        .content-wrapper {
            max-height: 100vh;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <!-- Wrapper div to demonstrate the infinite scrollbar fix -->
    <div class="content-wrapper">
    <div class="container-fluid py-4">
        <h1>Game Detail Test Page</h1>
        
        <!-- Task Progress Section -->
        <div class="row mb-4">
            <div class="col-md-8">
                <div class="card mb-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Task Progress</h5>
                        <a href="#" class="btn btn-sm btn-outline-primary">View All Tasks</a>
                    </div>
                    <div class="card-body">
                        <!-- Task progress bars - each in its own row for better visibility -->
                        <div class="task-progress-container">
                            <!-- Done tasks -->
                            <div class="d-flex justify-content-between mb-1">
                                <span>Done</span>
                                <span>25%</span>
                            </div>
                            <div class="progress mb-3">
                                <div class="progress-bar progress-done" role="progressbar" 
                                     aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                                </div>
                            </div>
                            
                            <!-- In Review tasks -->
                            <div class="d-flex justify-content-between mb-1">
                                <span>In Review</span>
                                <span>15%</span>
                            </div>
                            <div class="progress mb-3">
                                <div class="progress-bar progress-review" role="progressbar"
                                     aria-valuenow="15" aria-valuemin="0" aria-valuemax="100">
                                </div>
                            </div>
                            
                            <!-- In Progress tasks -->
                            <div class="d-flex justify-content-between mb-1">
                                <span>In Progress</span>
                                <span>30%</span>
                            </div>
                            <div class="progress mb-3">
                                <div class="progress-bar progress-in-progress" role="progressbar"
                                     aria-valuenow="30" aria-valuemin="0" aria-valuemax="100">
                                </div>
                            </div>
                            
                            <!-- To Do tasks -->
                            <div class="d-flex justify-content-between mb-1">
                                <span>To Do</span>
                                <span>20%</span>
                            </div>
                            <div class="progress mb-3">
                                <div class="progress-bar progress-todo" role="progressbar"
                                     aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                </div>
                            </div>
                            
                            <!-- Blocked tasks -->
                            <div class="d-flex justify-content-between mb-1">
                                <span>Blocked</span>
                                <span>10%</span>
                            </div>
                            <div class="progress mb-3">
                                <div class="progress-bar progress-blocked" role="progressbar"
                                     aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4">
                <!-- Asset Stats -->
                <div class="card mb-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Assets</h5>
                        <a href="#" class="btn btn-sm btn-outline-primary">View All</a>
                    </div>
                    <div class="card-body asset-stats">
                        <div class="chart-container">
                            <canvas id="assetChart" width="100%" height="200"></canvas>
                        </div>
                        
                        <div class="mt-4 asset-list">
                            <div class="asset-list-item">
                                <span>2D Art</span>
                                <span class="badge bg-primary">15</span>
                            </div>
                            <div class="asset-list-item">
                                <span>3D Models</span>
                                <span class="badge bg-success">8</span>
                            </div>
                            <div class="asset-list-item">
                                <span>Animation</span>
                                <span class="badge bg-info">5</span>
                            </div>
                            <div class="asset-list-item">
                                <span>Sound</span>
                                <span class="badge bg-warning">12</span>
                            </div>
                            <div class="asset-list-item">
                                <span>Music</span>
                                <span class="badge bg-danger">3</span>
                            </div>
                            <div class="asset-list-item">
                                <span>Code</span>
                                <span class="badge bg-secondary">20</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mock data for testing -->
    <script id="asset-data" type="application/json">
        {
            "art_2d": 15,
            "model_3d": 8,
            "animation": 5,
            "sound": 12,
            "music": 3,
            "code": 20
        }
    </script>
    
    <script id="task-data" type="application/json">
        {
            "done": 25,
            "in_review": 15,
            "in_progress": 30,
            "to_do": 20,
            "blocked": 10
        }
    </script>

    <!-- Include Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    
    <!-- Include Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Include our JavaScript directly for testing -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set progress bar widths from task data
            setupProgressBars();
            
            // Initialize asset statistics chart
            setupAssetChart();
        });

        /**
         * Sets up the task progress bars with dynamic widths
         */
        function setupProgressBars() {
            try {
                // Get task data from the JSON script element
                const taskDataElement = document.getElementById('task-data');
                if (!taskDataElement) return;
                
                const taskData = JSON.parse(taskDataElement.textContent);
                
                // Set widths for progress bars
                setProgressWidth('.progress-done', taskData.done);
                setProgressWidth('.progress-review', taskData.in_review);
                setProgressWidth('.progress-in-progress', taskData.in_progress);
                setProgressWidth('.progress-todo', taskData.to_do);
                setProgressWidth('.progress-blocked', taskData.blocked);
            } catch (error) {
                console.error('Error setting up progress bars:', error);
            }
        }

        /**
         * Helper function to set progress bar width with fallback
         */
        function setProgressWidth(selector, value) {
            const element = document.querySelector(selector);
            if (element) {
                const width = (value || 0) + '%';
                element.style.width = width;
                element.setAttribute('aria-valuenow', value || 0);
                
                // Add percentage text if width is sufficient
                if ((value || 0) > 5) {
                    element.textContent = width;
                }
            }
        }

        /**
         * Sets up the asset statistics doughnut chart
         */
        function setupAssetChart() {
            try {
                // Get asset data from the JSON script element
                const assetDataElement = document.getElementById('asset-data');
                if (!assetDataElement) return;
                
                const assetData = JSON.parse(assetDataElement.textContent);
                
                // Get chart canvas context
                const ctx = document.getElementById('assetChart');
                if (!ctx) return;
                
                // Create chart
                new Chart(ctx.getContext('2d'), {
                    type: 'doughnut',
                    data: {
                        labels: ['2D Art', '3D Models', 'Animation', 'Sound', 'Music', 'Code'],
                        datasets: [{
                            data: [
                                assetData.art_2d || 0,
                                assetData.model_3d || 0,
                                assetData.animation || 0,
                                assetData.sound || 0,
                                assetData.music || 0,
                                assetData.code || 0
                            ],
                            backgroundColor: [
                                '#4e73df', '#1cc88a', '#36b9cc', '#f6c23e', '#e74a3b', '#858796'
                            ]
                        }]
                    },
                    options: {
                        maintainAspectRatio: false,
                        legend: {
                            display: false
                        },
                        cutoutPercentage: 70
                    }
                });
            } catch (error) {
                console.error('Error setting up asset chart:', error);
            }
        }
    </script>
    </div> <!-- End of content-wrapper -->
</body>
</html>
